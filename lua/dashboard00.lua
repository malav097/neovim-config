-- pcall(function()

vim.api.nvim_create_autocmd("VimEnter", {
  group = group,
  callback = function()
    -- Only when launched without files/stdin
    if vim.fn.argc() ~= 0 or vim.fn.line2byte("$") ~= -1 then
      return
    end

    -- remember your global defaults (for restoring later)
    local default_number = vim.o.number
    local default_relativenumber = vim.o.relativenumber

    -- Create an unlisted scratch buffer (like dashboards do)
    local buf = vim.api.nvim_create_buf(false, true) -- listed=false, scratch=true
    vim.api.nvim_set_current_buf(buf)

    -- Buffer/window options so :wqa! never complains
    vim.bo[buf].buftype = "nofile"
    vim.bo[buf].bufhidden = "wipe"
    vim.bo[buf].swapfile = false
    vim.bo[buf].filetype = "startscreen"
    vim.bo[buf].modifiable = true
    local nvim_version = vim.version()
        local version_str = string.format(
"==================== Neovim Version: v%d.%d.%d ================================",
            nvim_version.major,
            nvim_version.minor,
            nvim_version.patch
          )



    -- Replace the old `local lines = { ... }` with this:
    local art = [[
===============================================================================  
===============================================================================
========                                    .-----.          ==================
========         .----------------------.   | === |          ==================
========         |.-""""""""""""""""""-.|   |-----|          ==================
========         ||                    ||   | === |          ==================
========         || malav-config-ver:  ||   |-----|          ==================
========         ||      0.3.0         ||   | === |          ==================
========         ||                    ||   |-----|          ==================
========         ||                    ||   |:::::|          ==================
========         |'-..................-'|   |____o|          ==================
========         `"")----------------(""`   ___________      ==================
========        /::::::::::|  |::::::::::\  \          \     ==================
========       /:::========|  |==hjkl==:::\  \          \    ==================
========      '""""""""""""'  '""""""""""""'  '""""""""""'   ==================
========                                                     ==================
===============================================================================
===============================================================================
==========_  _ _  _ _ _  _    ____ ____ _  _ ____ _ ____=======================
==========|\ | |  | | |\/|    |    |  | |\ | |___ | | __=======================
==========| \|  \/  | |  |    |___ |__| | \| |    | |__]=======================
===============================================================================
===============================================================================
===================0000000000000000000000000000================================
=================00                         000================================
================00000000000000000000000000000 0================================
================0                          00 0================================
================0                          00 0================================
================0                          00 0================================
================0      0000       0000     00 0================================
================0      0000       0000     00 0================================
================0                          00 0================================
================0                          00 0================================
================0           000008         00 0================================
================0        00       000      00 0================================
================0      00           00     00 0================================
================0                          00 0================================
================0                          00 0================================
================0                          0000================================
================00000000000000000000000000000==================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
===============================================================================
]]



    local lines = vim.split(art, "\n", { plain = true })
    -- Replace the first line with version info
    lines[1] = version_str

    vim.api.nvim_buf_set_lines(buf, 0, -1, false, lines)
    -- === make the art pink ===
    vim.opt.termguicolors = true
    local ns = vim.api.nvim_create_namespace("StartscreenArt")
    vim.api.nvim_set_hl(0, "StartscreenArtPink", { fg = "#ff69b4" }) -- hot pink
    for i = 0, #lines - 1 do
      vim.api.nvim_buf_add_highlight(buf, ns, "StartscreenArtPink", i, 0, -1)
    end

    -- Lock it down like dashboards
    vim.bo[buf].modifiable = false
    vim.bo[buf].readonly = true
    vim.bo[buf].modified = false -- <- crucial so :wqa! doesn't complain

    vim.schedule(function()
      -- create right split and move focus there
      vim.cmd("vsplit")
      vim.cmd("enew") -- open empty buffer
      vim.cmd("wincmd l")

      -- launch Telescope via Lua (avoid :Telescope)
      require("telescope.builtin").find_files({
        layout_strategy = "cursor",
        layout_config = {
          width = 0.4, -- feels like a right sidebar
          height = 0.95,
          preview_cutoff = 0,
          preview_width = 0,
        },
        sorting_strategy = "ascending",
        default_text = "", -- force empty prompt, even if something sneaks in
      })
    end)
  end,
})
